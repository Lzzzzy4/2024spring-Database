<!DOCTYPE html>
<!-- CREATE TABLE Projects (
    项目号 CHAR(5) PRIMARY KEY,
    项目名称 VARCHAR(256) NOT NULL,
    项目来源 VARCHAR(256) NOT NULL,
    项目类型 INT CHECK (项目类型 IN (1, 2, 3, 4, 5)),
    总经费 FLOAT NOT NULL,
    起始月份 DATE NOT NULL,
    结束月份 DATE
); -->
<html lang="en">
<head>
<base href="./">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>教师教学科研登记系统</title>
<link href="{{ url_for('static', filename='style1.css') }}" rel="stylesheet">
<script>
    function openForm(key) {
      var form = document.getElementById("updateForm");
      form.style.display = "block";
      update_form.key.value = key;
    }

    function closeForm() {
      document.getElementById("updateForm").style.display = "none";
    }

    function openwForm(key) {
      document.getElementById("deleteWarning").style.display = "block";
      delete_form.key.value = key;
    }

    function closewForm() {
      document.getElementById("deleteWarning").style.display = "none";
    } 
  </script>
<!-- </script>
<script type="text/javascript">
	function checkSelectSet(e) {
		var input = e.target,
			list = input.getAttribute('list'),
			options = document.querySelectorAll('#' + list + ' option[value="'+input.value+'"]'),
			hiddenInput = document.getElementById(input.getAttribute('id').replace('-display', ''));

		if (options.length > 0) {
			  hiddenInput.value = input.value;
			  input.value = options[0].innerText;
		  }
	}

	function addDataListListener(eid) {
		document.querySelector('#'+eid).addEventListener('input', checkSelectSet)
	}
</script> -->
</head>

<body class="app header-fixed sidebar-fixed aside-menu-fixed sidebar-lg-show">
<div class="form-popup" id="updateForm">
  <form class="form-container" name="update_form" method="POST">
    <h1>更新</h1>
    <div class="small text-muted">缺省值不变</div>
    <input type="hidden" name="key" value="">
    <input type="hidden" name="type" value="update">
    <label for="email"><b>项目号</b></label>
    <input type="text" placeholder="项目号" name="项目号">
    <label for="email"><b>项目名称</b></label>
    <input type="text" placeholder="项目名称" name="项目名称">
    <label for="email"><b>项目来源</b></label>
    <input type="text" placeholder="项目来源" name="项目来源">
    <label for="email"><b>项目类型</b></label>
    <input type="text" placeholder="项目类型" name="项目类型" list="type_list">
    <datalist id="type_list">
      <option value="1">国家级项目</option>
      <option value="2">省部级项目</option>
      <option value="3">市厅级项目</option>
      <option value="4">企业合作项目</option>
      <option value="5">其它类型项目</option>
    </datalist>
    <label for="email"><b>总经费</b></label>
    <input type="text" placeholder="总经费" name="总经费">
    <label for="email"><b>起始月份</b></label>
    <input type="text" placeholder="起始月份" name="起始月份">
    <label for="email"><b>结束月份</b></label>
    <input type="text" placeholder="结束月份" name="结束月份">
    <button type="submit" class="btn btn-success" value="Refresh Page" onclick="window.location.reload();">确认</button>
    <button type="button" class="btn bg-danger" onclick="closeForm()">取消</button>
  </form>
</div>
<div class="form-popup" id="deleteWarning">
  <form class="form-container" name="delete_form" method="POST">
    <p> </p>
    <h2>确认删除？</h2>
    <p> </p>
    <p> </p>
    <input type="hidden" name="type" value="delete">
    <input type="hidden" name="key" value="">
    <button type="submit" class="btn btn-success" value="Refresh Page" onclick="window.location.reload();">确认</button>
    <button type="button" class="btn bg-danger" onclick="closewForm();">取消</button>
  </form>
</div>
<header class="app-header navbar"><span class="badge badge-light">数据库系统及应用Lab</span> </header>
<div class="app-body">
  <div class="sidebar">
    <nav class="sidebar-nav">
      <ul class="nav">
        <li class="nav-title">教师教学科研登记系统</li>
        <!-- <a class="nav-link" href="index"> <i class="nav-icon icon-speedometer"></i> 首页 </a> -->
        <li class="nav-item nav-dropdown"> <a class="nav-link nav-dropdown-toggle" href="teacher"> <i class="nav-icon icon-puzzle"></i> 教师</a> </li>
        <li class="nav-item nav-dropdown"> <a class="nav-link nav-dropdown-toggle" href="paper"> <i class="nav-icon icon-cursor"></i> 论文</a> </li>
        <li class="nav-item nav-dropdown"> <a class="nav-link nav-dropdown-toggle" href="course"> <i class="nav-icon icon-cursor"></i> 课程</a> </li>
        <li class="nav-item nav-dropdown"> <a class="nav-link nav-dropdown-toggle" href="project"> <i class="nav-icon icon-star"></i> 项目</a> </li>
      </ul>
    </nav>
    <button class="sidebar-minimizer brand-minimizer" type="button"></button>
  </div>
  <main class="main">
    <div class="container-fluid">
      <div class="animated fadeIn">
        <div class="card">
          <div class="insert-container">
                <h4 class="card-title mb-0">查询</h4>
                <form class="form-insert" method="POST">
                  <input type="hidden" name="type" value="query">
                  <input type="text" placeholder="项目号" name="项目号">
                  <input type="text" placeholder="项目名称" name="项目名称">
                  <input type="text" placeholder="项目来源" name="项目来源">
                  <input type="text" placeholder="项目类型" name="项目类型" list="type_list">
                  <datalist id="type_list">
                    <option value="1">国家级项目</option>
                    <option value="2">省部级项目</option>
                    <option value="3">市厅级项目</option>
                    <option value="4">企业合作项目</option>
                    <option value="5">其它类型项目</option>
                  </datalist>
                  <input type="text" placeholder="总经费" name="总经费">
                  <input type="text" placeholder="起始月份" name="起始月份">
                  <input type="text" placeholder="结束月份" name="结束月份">
                  <button class="btn btn-info" type="submit">查询</button>
                </form>
          </div>
        </div>
        <div class="card">
          <div class="card-body">
            <div class="row">
              <div class="col-sm-5">
                <h4 class="card-title mb-0">项目</h4>
                <!-- <div class="small text-muted">2021 6</div> -->
              </div>
            </div>
            <div>             
              <div>
                <table id="bank-table">
                  <tr> {% for i in labels %}
                    <th> {{ i }} </th>
                    {% endfor %}
                    <th>操作</th>
                  </tr>
                  {% for i in content %}
                  <tr id="{{ i.项目号 }}">
                    <td> {{ i.项目号 }} </td>
                    <td> {{ i.项目名称 }} </td>
                    <td> {{ i.项目来源 }} </td>
                    <td> {{ i.项目类型 }} </td>
                    <td> {{ i.总经费 }} </td>
                    <td> {{ i.起始月份 }} </td>
                    <td> {{ i.结束月份 }} </td>
                    <td><label class="btn btn-success" onclick="openForm(this.parentNode.parentNode.id)">更新</label>
                      <label class="btn bg-danger" onclick="openwForm(this.parentNode.parentNode.id)">删除</label></td>
                  </tr>
                  {% endfor %}
                </table>
              </div>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="insert-container">
            <h4 class="card-title mb-0">新建</h4>
            <!-- <div class="small text-muted">请勿缺省</div> -->
            <form class="form-insert" method="POST">
              <input type="hidden" name="type" value="insert">
              <input type="text" placeholder="项目号" name="项目号" required="">
              <input type="text" placeholder="项目名称" name="项目名称" required="">
              <input type="text" placeholder="项目来源" name="项目来源" required="">
              <input type="text" placeholder="项目类型" name="项目类型" required="" list="type_list">
              <datalist id="type_list">
                <option value="1">国家级项目</option>
                <option value="2">省部级项目</option>
                <option value="3">市厅级项目</option>
                <option value="4">企业合作项目</option>
                <option value="5">其它类型项目</option>
              </datalist>
              <input type="text" placeholder="总经费" name="总经费" required="">
              <input type="text" placeholder="起始月份" name="起始月份" required="">
              <input type="text" placeholder="结束月份(可缺省)" name="结束月份">
              <button class="btn btn-warning" type="submit">新建</button>
            </form>
          </div>
        </div>

        <div class="card">
          <div class="insert-container">
                <h4 class="card-title mb-0">查询项目承担情况</h4>
                <form class="form-insert" method="POST">
                  <input type="hidden" name="type" value="query_1">
                  <input type="text" placeholder="老师工号" name="工号">
                  <input type="text" placeholder="项目号" name="项目号">
                  <button class="btn btn-info" type="submit">查询</button>
                </form>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <div class="row">
              <div class="col-sm-5">
                <h4 class="card-title mb-0">项目承担</h4>
              </div>
            </div>
            <div>             
              <div>
                <table id="bank-table">
                  <tr> {% for i in labels1 %}
                    <th> {{ i }} </th>
                    {% endfor %}
                    <th>操作</th>
                  </tr>
                  {% for i in content1 %}
                  <tr id="{{ i.工号 }}">
                    <td> {{ i.工号 }} </td>
                    <td> {{ i.姓名 }} </td>
                    <td> {{ i.项目号 }} </td>
                    <td> {{ i.项目名称 }} </td>
                    <td> {{ i.排名 }} </td>
                    <td> {{ i.承担经费 }} </td>
                    <td><label class="btn btn-success" onclick="openForm(this.parentNode.parentNode.id)">更新</label>
                      <label class="btn bg-danger" onclick="openwForm(this.parentNode.parentNode.id)">删除</label></td>
                  </tr>
                  {% endfor %}
                </table>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </main>
  <aside class="aside-menu">
    <ul class="nav nav-tabs" role="tablist">
      <li class="nav-item"> <a class="nav-link active" data-toggle="tab" href="#timeline" role="tab"> <i class="icon-list"></i> </a> </li>
      <li class="nav-item"> <a class="nav-link" data-toggle="tab" href="#messages" role="tab"> <i class="icon-speech"></i> </a> </li>
      <li class="nav-item"> <a class="nav-link" data-toggle="tab" href="#settings" role="tab"> <i class="icon-settings"></i> </a> </li>
    </ul>    
  </aside>
</div>
</body>
</html>